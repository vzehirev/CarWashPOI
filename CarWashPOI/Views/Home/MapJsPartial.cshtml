<script>
    $(document).ready(drawMap);

    function drawMap() {
        let map = L.map("map").setView([42.7510, 25.2379], 8);

        L.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}", {
            maxZoom: 21,
            id: "mapbox/streets-v11",
            tileSize: 512,
            zoomOffset: -1,
            accessToken: "pk.eyJ1IjoidnplaGlyZXYiLCJhIjoiY2s3NGpvNGJsMDYwcDNmbzNqZXM2enM4MiJ9.XENUDCk7i7evvkHshJjKUg",
        })
            .addTo(map);

        addLocationsToMap(map);
    }

    function addLocationsToMap(map) {
        $.ajax({
            url: "/Rest/Locations",
        })
            .done(function (allLocations) {
                for (let location of allLocations) {
                    let marker = L.marker([location.latitude, location.longitude]);
                    marker.bindPopup(`<b>${location.title}</b><br><a href='/Locations/${location.id}'>Виж повече</a>`);
                    marker.addTo(map);
                }
            });
    }
</script>